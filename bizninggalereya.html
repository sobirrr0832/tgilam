<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bizning Toshgilamlar Galereyasi</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: 'Inter', sans-serif;
            background: #ffffff;
            color: #0f172a;
            padding: 80px 0;
            overflow-x: hidden;
        }
        :root { --primary: #6366f1; --dark: #0f172a; --gray: #64748b; }

        .scrolling-gallery { padding: 100px 0; background: white; position: relative; overflow: hidden; }
        .gallery-header { max-width: 1400px; margin: 0 auto 60px; padding: 0 40px; text-align: center; }
        .gallery-header h2 { font-size: 3rem; font-weight: 800; margin-bottom: 16px; letter-spacing: -1px; color: var(--dark); }
        .gallery-header p { font-size: 1.2rem; color: var(--gray); max-width: 700px; margin: 0 auto; }

        .gallery-container { position: relative; overflow: hidden; padding: 0 80px; }
        .gallery-track {
            display: flex;
            gap: 24px;
            will-change: transform;
        }

        .gallery-item-link {
            text-decoration: none;
            color: inherit;
            pointer-events: none;
        }

        .gallery-item {
            width: 400px;
            height: 280px;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            flex-shrink: 0;
            box-shadow: 0 8px 24px rgba(0,0,0,0.08);
            user-select: none;
            -webkit-user-drag: none;
        }
        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            pointer-events: none;
            user-select: none;
            -webkit-user-drag: none;
            draggable: false;
        }
        .gallery-item::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(180deg, transparent 50%, rgba(0,0,0,0.5));
            border-radius: 20px;
            pointer-events: none;
        }
        .gallery-overlay {
            position: absolute;
            bottom: 0; left: 0; right: 0;
            padding: 24px;
            color: white;
            text-shadow: 0 2px 8px rgba(0,0,0,0.6);
            pointer-events: none;
            z-index: 1;
        }
        .gallery-overlay h3 { font-size: 1.4rem; font-weight: 700; margin-bottom: 6px; }
        .gallery-overlay p { font-size: 0.95rem; opacity: 0.95; }

        .nav-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.95);
            border: none;
            width: 50px; height: 50px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
        }
        .nav-btn:hover { background: white; box-shadow: 0 6px 30px rgba(0,0,0,0.25); transform: translateY(-50%) scale(1.1); }
        .nav-btn i { font-size: 20px; color: var(--dark); }
        .nav-btn.prev { left: 20px; }
        .nav-btn.next { right: 20px; }

        /* Rasmlarni himoya qilish */
        img { -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; }

        /* Mobil rejimda o‘qlar (nav-btn) butunlay yashiriladi */
        @media (max-width: 768px) {
            .nav-btn { display: none !important; }
            .gallery-header h2 { font-size: 2.2rem; }
            .gallery-item { width: 320px; height: 230px; }
            .gallery-container { padding: 0 20px; } /* chetlardan bo‘sh joyni kamaytirdik */
        }

        @media (max-width: 480px) {
            .gallery-item { width: 280px; height: 200px; }
            .gallery-overlay h3 { font-size: 1.2rem; }
            .gallery-container { padding: 0 10px; }
        }
    </style>
</head>
<body>

<section class="scrolling-gallery">
    <div class="gallery-header">
        <h2>Bizning toshgilamlar galereyasi</h2>
        <p>Bu materiallar mustahkam, estetik va uzoq muddatli, chidamli</p>
    </div>

    <div class="gallery-container">
        <button class="nav-btn prev" aria-label="Oldinga"><i class="fas fa-chevron-left"></i></button>
        <div class="gallery-track" id="galleryTrack"></div>
        <button class="nav-btn next" aria-label="Orqaga"><i class="fas fa-chevron-right"></i></button>
    </div>
</section>

<script>
    const galleryData = [
        { img: 'gimg/g01.webp', title: 'Shabnam', desc: 'ertalab shabnamday tiniq' },
        { img: 'gimg/g02.webp', title: 'Temuriy', desc: 'aralash rangdagi silliq yuvilgan toshlar' },
        { img: 'gimg/g03.webp', title: "Oytog'", desc: "tabiatning mutanosib va sokin go'zalligi" },
        { img: 'gimg/g04.webp', title: 'Kohinur', desc: 'juda mayda va silliqlangan toshlar' },
        { img: 'gimg/g05.webp', title: 'Zarnigor', desc: "tabiiy toshlar va oq kristal uyg'unligi" },
        { img: 'gimg/g06.webp', title: 'Safonur', desc: "nafislik va kontrastninig uyg'unligi" },
        { img: 'gimg/g07.webp', title: 'Suvoriy', desc: 'tabiatda yaralgan noziklik' },
        { img: 'gimg/g08.webp', title: 'Safir', desc: "tabiiy iliqlik va ranglar uyg'unligi" }
    ];

    const track = document.getElementById('galleryTrack');
    const totalItems = galleryData.length;

    // Mobil yoki desktop ekanligini aniqlash uchun
    const isMobile = window.innerWidth <= 768;

    // Mobil bo‘lsa gap ni kattaroq qilamiz, shunda oxirgi rasm ham to‘liq ko‘rinadi va ortiqcha bo‘sh joy qolmaydi
    const baseGap = 24;
    const gap = isMobile ? 16 : baseGap;

    // Har bir elementning to‘liq kengligi (kartochka + gap)
    const itemWidth = (isMobile ? 320 : 400) + gap;

    let currentIndex = totalItems; // o‘rtadan boshlash (cheksiz aylanish uchun)
    let isMoving = false;

    // Galereyani yaratish
    function renderGallery() {
        track.innerHTML = '';
        track.style.gap = `${gap}px`; // flex gap ni dinamik qilamiz

        // Oldin, o‘rta va keyin nusxalar (cheksiz scroll uchun)
        [...galleryData, ...galleryData, ...galleryData, ...galleryData, ...galleryData].forEach(item => {
            const div = document.createElement('div');
            div.className = 'gallery-item-link';
            div.innerHTML = `
                <div class="gallery-item" style="width:${isMobile ? 320 : 400}px; height:${isMobile ? 230 : 280}px;">
                    <img src="${item.img}" alt="${item.title}" loading="lazy" draggable="false">
                    <div class="gallery-overlay">
                        <h3>${item.title}</h3>
                        <p>${item.desc}</p>
                    </div>
                </div>
            `;
            track.appendChild(div);
        });

        // Boshlang‘ich joylashuv
        track.style.transition = 'none';
        track.style.transform = `translateX(${-currentIndex * itemWidth}px)`;
        requestAnimationFrame(() => {
            track.style.transition = 'transform 0.6s cubic-bezier(0.22, 0.61, 0.36, 1)';
        });
    }

    function move(direction) {
        if (isMoving) return;
        isMoving = true;

        currentIndex += direction;
        track.style.transform = `translateX(${-currentIndex * itemWidth}px)`;

        track.addEventListener('transitionend', function handler() {
            track.removeEventListener('transitionend', handler);

            // Cheksiz aylanishni ta'minlash
            if (currentIndex >= totalItems * 3) {
                currentIndex -= totalItems;
                track.style.transition = 'none';
                track.style.transform = `translateX(${-currentIndex * itemWidth}px)`;
                requestAnimationFrame(() => track.style.transition = 'transform 0.6s cubic-bezier(0.22, 0.61, 0.36, 1)');
            }
            if (currentIndex < totalItems) {
                currentIndex += totalItems;
                track.style.transition = 'none';
                track.style.transform = `translateX(${-currentIndex * itemWidth}px)`;
                requestAnimationFrame(() => track.style.transition = 'transform 0.6s cubic-bezier(0.22, 0.61, 0.36, 1)');
            }

            isMoving = false;
        });
    }

    // Autoplay
    let autoPlay = null;
    function startAutoPlay() {
        if (autoPlay) clearInterval(autoPlay);
        autoPlay = setInterval(() => move(1), 4000); // o‘ngga siljish
    }

    function stopAutoPlay() {
        if (autoPlay) clearInterval(autoPlay);
        autoPlay = null;
    }

    // Tugmalar (faqat desktopda ishlaydi, mobil uchun yashirilgan)
    document.querySelector('.nav-btn.prev').onclick = () => { stopAutoPlay(); move(-1); setTimeout(startAutoPlay, 8000); };
    document.querySelector('.nav-btn.next').onclick = () => { stopAutoPlay(); move(1); setTimeout(startAutoPlay, 8000); };

    // Klaviatura
    document.addEventListener('keydown', e => {
        if (e.key === 'ArrowLeft') { stopAutoPlay(); move(-1); setTimeout(startAutoPlay, 8000); }
        if (e.key === 'ArrowRight') { stopAutoPlay(); move(1); setTimeout(startAutoPlay, 8000); }
    });

    // Swipe (mobil uchun)
    let touchStartX = 0;
    let touchEndX = 0;
    const container = document.querySelector('.gallery-container');

    container.addEventListener('touchstart', e => touchStartX = e.changedTouches[0].screenX, {passive: true});
    container.addEventListener('touchend', e => {
        touchEndX = e.changedTouches[0].screenX;
        const diff = touchStartX - touchEndX;
        if (Math.abs(diff) > 50) {
            stopAutoPlay();
            move(diff > 0 ? 1 : -1);
            setTimeout(startAutoPlay, 8000);
        }
    });

    // Himoya
    document.addEventListener('contextmenu', e => e.preventDefault());
    document.onselectstart = e => e.preventDefault();
    document.ondragstart = e => e.preventDefault();

    // Boshlash
    renderGallery();
    startAutoPlay();

    // Ekranni o‘lchamini o‘zgartirganda qayta render qilish (mobil ↔ desktop)
    window.addEventListener('resize', () => {
        if ((window.innerWidth <= 768) !== isMobile) {
            location.reload();
        }
    });
</script>

</body>
</html>
